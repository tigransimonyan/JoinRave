{"version":3,"sources":["assets/play.svg","assets/pause.svg","anim.js","App.js","index.js"],"names":["noise","window","SimplexNoise","playWithAnim","audio","context","AudioContext","src","createMediaElementSource","analyser","createAnalyser","connect","destination","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","scene","THREE","Scene","group","Group","camera","PerspectiveCamera","innerWidth","innerHeight","position","set","lookAt","add","renderer","WebGLRenderer","alpha","antialias","setSize","planeGeometry","PlaneGeometry","planeMaterial","MeshLambertMaterial","color","side","DoubleSide","wireframe","plane","Mesh","rotation","x","Math","PI","plane2","icosahedronGeometry","IcosahedronGeometry","lambertMaterial","ball","ambientLight","AmbientLight","spotLight","SpotLight","makeRoughGround","mesh","distortionFr","geometry","vertices","forEach","vertex","i","time","Date","now","distance","noise2D","y","z","verticesNeedUpdate","normalsNeedUpdate","computeVertexNormals","computeFaceNormals","intensity","castShadow","document","getElementById","appendChild","domElement","addEventListener","aspect","updateProjectionMatrix","render","getByteFrequencyData","lowerHalfArray","slice","length","upperHalfArray","lowerMax","avg","max","lowerAvg","upperMax","upperAvg","lowerMaxFr","upperAvgFr","modulate","bassFr","pow","treFr","offset","parameters","radius","amp","performance","normalize","rf","noise3D","multiplyScalar","requestAnimationFrame","play","val","minVal","maxVal","outMin","outMax","fractionate","arr","reduce","sum","b","a","Audio","App","useState","playing","setPlaying","canplay","setCanplay","useEffect","process","load","useCallback","pause","onCanplay","onPlay","onEnded","onPause","removeEventListener","useLayoutEffect","id","className","alt","PauseIcon","onClick","PlayIcon","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.9156b01f.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/play.67fb6362.svg\";","export default __webpack_public_path__ + \"static/media/pause.12407eb8.svg\";","var noise = new window.SimplexNoise();\n\nexport function playWithAnim(audio) {\n  var context = new AudioContext();\n  var src = context.createMediaElementSource(audio);\n  var analyser = context.createAnalyser();\n  src.connect(analyser);\n  analyser.connect(context.destination);\n  analyser.fftSize = 512;\n  var bufferLength = analyser.frequencyBinCount;\n  var dataArray = new Uint8Array(bufferLength);\n  var scene = new window.THREE.Scene();\n  var group = new window.THREE.Group();\n  var camera = new window.THREE.PerspectiveCamera(\n    45,\n    window.innerWidth / window.innerHeight,\n    0.1,\n    1000\n  );\n  camera.position.set(0, 0, 100);\n  camera.lookAt(scene.position);\n  scene.add(camera);\n\n  var renderer = new window.THREE.WebGLRenderer({ alpha: true, antialias: true });\n  renderer.setSize(window.innerWidth, window.innerHeight);\n\n  var planeGeometry = new window.THREE.PlaneGeometry(800, 800, 20, 20);\n  var planeMaterial = new window.THREE.MeshLambertMaterial({\n    color: 0x6904ce,\n    side: window.THREE.DoubleSide,\n    wireframe: true,\n  });\n\n  var plane = new window.THREE.Mesh(planeGeometry, planeMaterial);\n  plane.rotation.x = -0.5 * Math.PI;\n  plane.position.set(0, 30, 0);\n  group.add(plane);\n\n  var plane2 = new window.THREE.Mesh(planeGeometry, planeMaterial);\n  plane2.rotation.x = -0.5 * Math.PI;\n  plane2.position.set(0, -30, 0);\n  group.add(plane2);\n\n  var icosahedronGeometry = new window.THREE.IcosahedronGeometry(10, 4);\n  var lambertMaterial = new window.THREE.MeshLambertMaterial({\n    color: 0xff00ee,\n    wireframe: true,\n  });\n\n  var ball = new window.THREE.Mesh(icosahedronGeometry, lambertMaterial);\n  ball.position.set(0, 0, 0);\n  group.add(ball);\n\n  var ambientLight = new window.THREE.AmbientLight(0xaaaaaa);\n  scene.add(ambientLight);\n\n  var spotLight = new window.THREE.SpotLight(0xffffff);\n  spotLight.intensity = 0.9;\n  spotLight.position.set(-10, 40, 20);\n  spotLight.lookAt(ball);\n  spotLight.castShadow = true;\n  scene.add(spotLight);\n\n  scene.add(group);\n\n  document.getElementById('out').appendChild(renderer.domElement);\n\n  window.addEventListener('resize', onWindowResize, false);\n\n  render();\n\n  function render() {\n    analyser.getByteFrequencyData(dataArray);\n\n    var lowerHalfArray = dataArray.slice(0, dataArray.length / 2 - 1);\n    var upperHalfArray = dataArray.slice(dataArray.length / 2 - 1, dataArray.length - 1);\n\n    var overallAvg = avg(dataArray);\n    var lowerMax = max(lowerHalfArray);\n    var lowerAvg = avg(lowerHalfArray);\n    var upperMax = max(upperHalfArray);\n    var upperAvg = avg(upperHalfArray);\n\n    var lowerMaxFr = lowerMax / lowerHalfArray.length;\n    var lowerAvgFr = lowerAvg / lowerHalfArray.length;\n    var upperMaxFr = upperMax / upperHalfArray.length;\n    var upperAvgFr = upperAvg / upperHalfArray.length;\n\n    makeRoughGround(plane, modulate(upperAvgFr, 0, 1, 0.5, 4));\n    makeRoughGround(plane2, modulate(lowerMaxFr, 0, 1, 0.5, 4));\n\n    makeRoughBall(\n      ball,\n      modulate(Math.pow(lowerMaxFr, 0.8), 0, 1, 0, 8),\n      modulate(upperAvgFr, 0, 1, 0, 4)\n    );\n\n    group.rotation.y += 0.005;\n    renderer.render(scene, camera);\n    requestAnimationFrame(render);\n  }\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n  }\n\n  function makeRoughBall(mesh, bassFr, treFr) {\n    mesh.geometry.vertices.forEach(function (vertex, i) {\n      var offset = mesh.geometry.parameters.radius;\n      var amp = 7;\n      var time = window.performance.now();\n      vertex.normalize();\n      var rf = 0.00001;\n      var distance =\n        offset +\n        bassFr +\n        noise.noise3D(\n          vertex.x + time * rf * 7,\n          vertex.y + time * rf * 8,\n          vertex.z + time * rf * 9\n        ) *\n          amp *\n          treFr;\n      vertex.multiplyScalar(distance);\n    });\n    mesh.geometry.verticesNeedUpdate = true;\n    mesh.geometry.normalsNeedUpdate = true;\n    mesh.geometry.computeVertexNormals();\n    mesh.geometry.computeFaceNormals();\n  }\n\n  function makeRoughGround(mesh, distortionFr) {\n    mesh.geometry.vertices.forEach(function (vertex, i) {\n      var amp = 2;\n      var time = Date.now();\n      var distance =\n        (noise.noise2D(vertex.x + time * 0.0003, vertex.y + time * 0.0001) + 0) *\n        distortionFr *\n        amp;\n      vertex.z = distance;\n    });\n    mesh.geometry.verticesNeedUpdate = true;\n    mesh.geometry.normalsNeedUpdate = true;\n    mesh.geometry.computeVertexNormals();\n    mesh.geometry.computeFaceNormals();\n  }\n\n  audio.play();\n}\n\nfunction fractionate(val, minVal, maxVal) {\n  return (val - minVal) / (maxVal - minVal);\n}\n\nfunction modulate(val, minVal, maxVal, outMin, outMax) {\n  var fr = fractionate(val, minVal, maxVal);\n  var delta = outMax - outMin;\n  return outMin + fr * delta;\n}\n\nfunction avg(arr) {\n  var total = arr.reduce(function (sum, b) {\n    return sum + b;\n  });\n  return total / arr.length;\n}\n\nfunction max(arr) {\n  return arr.reduce(function (a, b) {\n    return Math.max(a, b);\n  });\n}\n","import { useEffect, useState, useLayoutEffect, useCallback } from 'react';\nimport PlayIcon from './assets/play.svg';\nimport PauseIcon from './assets/pause.svg';\nimport { playWithAnim } from './anim';\n// import FullScreenIcon from './assets/fullscreen.svg';\n// import NormalScreenIcon from './assets/normalscreen.svg';\n// import FavoriteIcon from './assets/favorite.svg';\n\nconst audio = new Audio();\n\nfunction App() {\n  const [playing, setPlaying] = useState(false);\n  const [canplay, setCanplay] = useState(false);\n\n  useEffect(() => {\n    audio.src = process.env.REACT_APP_API;\n    audio.load();\n  }, []);\n\n  const play = useCallback(() => {\n    if (canplay) {\n      playWithAnim(audio);\n      setPlaying(true);\n    }\n  }, [canplay]);\n\n  const pause = useCallback(() => {\n    audio.pause();\n    setPlaying(false);\n  }, []);\n\n  const onCanplay = useCallback(() => {\n    if (!canplay) {\n      setCanplay(true);\n    }\n  }, [canplay]);\n\n  const onPlay = useCallback(() => {\n    if (!playing) {\n      play();\n    }\n  }, [playing, play]);\n\n  const onEnded = useCallback(() => play(), [play]);\n  const onPause = useCallback(() => pause(), [pause]);\n\n  useEffect(() => {\n    audio.addEventListener('play', onPlay);\n    audio.addEventListener('ended', onEnded);\n    audio.addEventListener('pause', onPause);\n    audio.addEventListener('canplay', onCanplay);\n    return () => {\n      audio.removeEventListener('play', onPlay);\n      audio.removeEventListener('ended', onEnded);\n      audio.removeEventListener('pause', onPause);\n      audio.removeEventListener('canplay', onCanplay);\n    };\n  }, [onPlay, onCanplay, onEnded, onPause]);\n\n  useLayoutEffect(() => {\n    try {\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  return (\n    <div id=\"main\">\n      <div id=\"out\"></div>\n      <div className=\"app\">\n        {playing ? (\n          <img className=\"pause\" alt=\"Pause\" src={PauseIcon} onClick={pause} />\n        ) : (\n          <img className=\"play\" alt=\"Play\" src={PlayIcon} onClick={play} />\n        )}\n        <div className=\"info\">\n          Live Stream from <b>Earth</b>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}